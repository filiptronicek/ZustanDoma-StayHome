function canMove(e,t){return t>=0&&t<board.length&&e>=0&&e<board[t].length&&1!=board[t][e]}function changeWindow(e){game.introduction.style="none",canvas.style.visibility="hidden","introduction"===e?game.introduction.style.display="flex":"game"===e&&(canvas.style.visibility="visible")}function checkForExistingPoint(e,t){}function generateNewPoint(e){function t(){const n=Math.floor(20*Math.random()),a=Math.floor(20*Math.random());canMove(n,a)?(ctx.drawImage(e,n*blockSize,a*blockSize,blockSize,blockSize),pills.push({x:n,y:a,imageObject:e})):t()}t()}function createPills(){pillsArray.forEach(e=>{let t=new Image;t.src=`images/colls/${e}.png`,generateNewPoint(t)})}function generateBoard(){for(let e=0;e<board.length;e++)for(let t=0;t<board[e].length;t++)1===board[e][t]&&ctx.drawImage(wall,t*blockSize,e*blockSize,blockSize,blockSize)}function introduction(){changeWindow("introduction"),game.startButton.addEventListener("click",startGame)}function startGame(){game.time=game.orgTime,createPills(),changeWindow("game"),timer(game.time),draw()}function endGame(e,t){"win"===e&&(game.endElement.style.display="block",game.endMessage.innerText=`You won! You have collected all the items in just ${game.orgTime-t[1]} seconds!`),"loss"===e&&(game.endElement.style.display="block",game.endMessage.innerText="You lost. Good luck next time!")}function timer(e){function t(e,t){var n,a,o=e;const l=setInterval(function(){n=parseInt(o/60,10),a=parseInt(o%60,10),game.score===pillsArray.length&&(clearInterval(l),endGame("win",[n,a])),0==o--&&(clearInterval(l),endGame("loss",[n,a])),n=n<10?"0"+n:n,a=a<10?"0"+a:a,t.innerText=n+":"+a,game.time=o},1e3)}display=document.querySelector("#time"),t(e,display)}function movement(){(keys[39]||keys[68])&&canMove(player.x+1,player.y)&&(hero.src="images/right.png",player.x++),(keys[37]||keys[65])&&canMove(player.x-1,player.y)&&(hero.src="images/left.png",player.x--),(keys[38]||keys[87])&&canMove(player.x,player.y-1)&&player.y--,(keys[40]||keys[83])&&canMove(player.x,player.y+1)&&player.y++}function draw(){ctx.clearRect(player.x*blockSize,player.y*blockSize,blockSize,blockSize),generateBoard(),movement(),collect(),ctx.drawImage(hero,player.x*blockSize,player.y*blockSize,blockSize,blockSize)}function collect(){for(let e=0;e<pills.length;e++)player.x==pills[e].x&&player.y==pills[e].y&&(pills.splice(e,1),increaseScore())}function increaseScore(){game.score++,game.scoreElement.textContent=`${game.score}/${pillsArray.length}`}let canvas=document.querySelector("#canvas"),ctx=canvas.getContext("2d"),blockSize=30,width=600,keys=[],pills=[],height=600;const board=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,0,1,1,1,1,1,0,0,0,0,0,1],[1,0,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,0,1],[1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,1],[1,0,1,0,0,1,1,0,0,0,1,1,1,1,1,0,0,0,0,1],[1,0,0,0,1,1,1,1,1,0,0,0,0,0,0,1,1,1,0,1],[1,0,0,1,1,0,0,1,0,0,1,1,0,1,0,0,0,1,0,1],[1,0,1,1,0,0,0,0,0,1,1,1,0,0,1,1,0,0,0,1],[1,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,0,1,1,1],[1,0,1,1,1,1,1,1,0,1,1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,1,0,1,1,0,1,0,1],[1,0,1,1,1,0,1,1,0,0,0,1,0,0,1,1,0,1,1,1],[1,0,0,0,0,1,1,1,0,1,0,1,0,1,0,0,0,0,0,1],[1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,0,1,0,1,1],[1,1,1,1,1,0,1,1,1,0,0,1,1,0,1,0,1,0,1,1],[1,0,1,0,0,0,0,1,0,1,0,1,0,1,0,0,0,0,1,1],[1,0,0,0,1,1,0,0,0,1,0,0,0,1,0,1,1,0,1,1],[1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]];let player={x:8,y:1},game={timeElement:document.getElementById("time"),introduction:document.querySelector("#introduction"),scoreElement:document.getElementById("score"),endElement:document.getElementById("end"),endMessage:document.getElementById("message"),startButton:document.querySelector("#start"),score:0,orgTime:30,time:0},hero=new Image;hero.src="images/right.png";let wall=new Image;wall.src="images/wall.png";const pillsArray=["lotion","toilet_paper","face_mask","pill2"];canvas.width=width,canvas.height=height,document.body.addEventListener("keydown",function(e){"none"==game.endElement.style.display&&(keys[e.keyCode]=!0,draw())}),document.body.addEventListener("keyup",function(e){"none"==game.endElement.style.display&&(keys[e.keyCode]=!1,draw())}),window.addEventListener("load",introduction);